node cumulative_sum (i:int) returns (t:int)
let
  t = (0 fby t) + i;
tel

node count_bananas (banana : bool) returns (n : int)
let
  n = merge banana
            (true -> cumulative_sum(1 when banana))
            (false -> (0 fby n) when not banana);
tel